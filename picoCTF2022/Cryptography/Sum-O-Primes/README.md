# Challenge Name: Sum-O-Primes
## Question

<img src= "/picoCTF2022/Cryptography/zimgsrc/Sum-O-Pr/Question.png" alt="img">

In this challenge, we are given two files and 1 hints. 

`Hint: I love squares :)`

Files: gen.py

<img src = "/picoCTF2022/Cryptography/zimgsrc/Sum-O-Pr/gen.py.png" alt="img">

Files: output.txt

```
x = 1c0e127fe9274dcd9830ecf0af5cf1c75e7c24106247495f3756d013d939ea66befa038012844379905cb0281cd4009f1bd6102680b8a029d69a51dbbfc1ddf77b21eeee42b0e4897cd2a541b99d41523e5cd44799cd209eeae33db029937aad6c5bb3f359dad8b780e1b07d73ac1d0cef6d5517ab78ec19d8dbe31d5322c6382
n = c4bf129f0b86c18115b8eabfc5399e366e75d703f191f993b56d433d86c2a7c85ff1304c9d9068893232ced732e769114873a6dfdc61949388a0bc8a1f4ef0332888e714c9deadb2439c532aa1c8210f8a90409f6e7776239eebf649149f02e005683c86e677ebf17506ed076eddf593696dbc58340dde1c3a7da443f0b27d3ba8e8f04e7139e199ef34cb88e26e3794b319a4018a6627203c479edd50cb9c5b2cdc8a8de14c6c0294e6ad13c95c98fe8e8f1b9587dc7f2ddbba1233a14ed831321323c1e68b525f8fb8a93bd7081e702606c7174d1534af66858c25c5b19304accde3a0659cd29c3c7cb411e015422b5a8fd0d403470553bc5f870b3506709d
c = 2c628ae700a75caf1be3e354599249dd9ae80f38c1ac8fdcd53167e918f53b1a1cbd42a5e57951d634c3f88b7e96787c8b19682a0ab5e78eb97dc87cf51e3099b0b2b105183ae524d170bdf4a3cd5fbccd021315a94e6a99220a876b970bee15b40c39794d5063c0fe9da2b728e641d3a488fc198363785224717985b5b8e0ee055f03d6b165ad6b9e0bf99dc50a371629ed012836c0cfa7073d708650bc4e7b8277a5ddab3aa5d6d7e0deea2266792898d8ef603850eab52c3d06cf8a93b7e91321b310035f867c32fea4238ba725a165ba972dd0aa543b41be82f67325fb9a2bfddcec9ae9a4f95f0981de531f4442ba6ee9d95e4ae11212137900ee0938ab

```


## Solution
Based on the tags, we can know that this challenge is about RSA cryptography. 

According to the gen.py script, it given the below details:
n = p * q
x = p + q
e = 65537

In order to get the phi value in RSA, we know that the formula is: phi = (p-1) * (q-1), which is also means as: phi = (p * q) - (p + q) + 1

Therefore, we can substitute the value x and value n into the phi formula, which is: phi = (n - x) + 1

Then, we can decode it with the normal RSA decryption. First, I've convert the value of x, n and c into the decimal value because the value given is in hexadecimal format. Then, replace the decimal value of x, n, c into the script and write a RSA decryption script to get the flags. 

Run the below script to get the flag. 
```
from Crypto.Util.number import *

x = 315213916102321363739027499508238000085851592044391921238432604996428678732095998126788549922262776224702242558499036490313535452462599581537179136049191488200377987558384174040497038679718268126793292734589251105268763819363756997919652560881765783323188644352595216055211502852121674603085456213516506391426
n =24836929252795955731132010546223709680843679782482437741046740213071600223163672914034663383148743177032338281498847908178160683167007556035238711307420350445749519671880120143689431949634200229486793074301025127706925537020900440354177200344851484674133325413064019264816452335021807356449228797486843593910605005857636498668952297399693019755850931897655273161929791078241956789641695192351794813681171638491897781118154196285384922816746035008327316822391336863774975397987565206920075263109270156468855420728199749341213801525255949465728862293798236029962191695368686910536656243026222177591993405400914925613213
c = 5603078579405605696975162617868780790348658867284713605696725491731767919562197050561882458908179505600780836388164719900234262346005397548767015171663500841580430950194825403609952340456669373536102432943069198478948520464325160280736574617345485667351503914592472500386116606872816067640718787200070334407277520043170126157889447780990201466376683411093639814790275934868102791152789716065124937762447145742021395983900153348328205815505442935009153423220878407353392671499387964032224154012306222121104330737573529360892607351062118997857516741266957504844649294929805848794558952051137952071091861964623339665579
e = 65537

phi=(n-x)+1 #phi = (p-1) * (q-1)

d=inverse(e,phi)

m=pow(c,d,n)

print(long_to_bytes(m))
```



## Flag
That's the flag !

<img src= "/picoCTF2022/Cryptography/zimgsrc/Sum-O-Pr/sol.py.png" alt="img">


`picoCTF{f5eab190}`
